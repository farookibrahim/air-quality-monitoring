(this["webpackJsonpair-quality-monitoring-client"]=this["webpackJsonpair-quality-monitoring-client"]||[]).push([[0],{22:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a.n(c),r=a(11),i=a.n(r),s=(a(21),a(22),a(2)),o=a(16),l=a(12),d=a(6),j=a(13),u=a.n(j),b=a(7),h=a.n(b);function x(e){var t=e.split(".");return{beforeDecimal:t[0],afterDecimal:t[1]||""}}function f(e,t,a){for(var c="",n=a?"0":"",r=0;r<=t-1;r++)c+=e[r]||n;return c}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=e.toString(),n=-1!==c.indexOf(".")||t&&a,r=x(c),i=r.beforeDecimal,s=r.afterDecimal;return i+(n?".":"")+(s=f(s,t,a))}function O(e){return e>400&&e<=500?{slug:"severe",label:"Severe"}:e>300&&e<=400?{slug:"very-poor",label:"Very Poor"}:e>200&&e<=300?{slug:"poor",label:"Poor"}:e>100&&e<=200?{slug:"moderate",label:"Moderate"}:e>50&&e<=100?{slug:"satisfactory",label:"Satisfactory"}:{slug:"good",label:"Good"}}function m(e){return{severe:"#8a0001","very-poor":"#ed1421",poor:"#f49717",moderate:"#fef100",satisfactory:"#8dca78",good:"#018c3f"}[O(e).slug]}var v=a(0);var g=function(e){var t=e.values;return Object(v.jsx)("div",{className:"row",children:Object(v.jsx)("div",{className:"col col-xl-10 mx-xl-auto mb-4",children:Object(v.jsxs)("table",{className:"table table-dark table-striped table-hover",children:[Object(v.jsx)("thead",{children:Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{children:"City"}),Object(v.jsx)("th",{children:"Current AQI"}),Object(v.jsx)("th",{children:"Last updated"})]})}),Object(v.jsx)("tbody",{children:t.map((function(e,t){var a=O(e.aqi),c=m(e.aqi);return Object(v.jsxs)("tr",{className:u()(Object(d.a)({},"category-".concat(a.slug),!0)),children:[Object(v.jsx)("td",{children:Object(v.jsx)("span",{children:e.city})}),Object(v.jsx)("td",{children:Object(v.jsx)("span",{style:{color:c},children:p(e.aqi)})}),Object(v.jsx)("td",{children:Object(v.jsx)(h.a,{fromNow:!0,children:e.updated})})]},t)}))})]})})})},y=a(9),N=a(14),q=a(8),w=a.n(q),S=a(15),k=a.n(S),C=function(e){return{city:e.filter((function(e){return"undefined"!==typeof e.city})).map((function(e){return e.city})),aqi:e.filter((function(e){return"undefined"!==typeof e.aqi})).map((function(e){return e.aqi})),updated:e.filter((function(e){return"undefined"!==typeof e.updated})).map((function(e){return e.updated}))}};var I=function(e){var t=C(e.values),a="chart-aqi-differences",n=[{name:"AQI",data:t.aqi}],r={theme:{mode:"dark"},chart:{id:a,type:"bar",height:350,background:"#212529",fontFamily:"Roboto, sans-serif",toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",endingShape:"rounded"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:t.city},yaxis:{min:0,max:500,tickAmount:6,forceNiceScale:!0,decimalsInFloat:0,title:{text:"AQI"}},fill:{opacity:1},colors:[function(e){return m(e.value)}],tooltip:{custom:function(e){var a=e.series,c=e.seriesIndex,n=e.dataPointIndex,r=e.w,i=O(a[c][n]),s=m(a[c][n]),o=Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("div",{className:"apexcharts-tooltip-title",children:r.globals.labels[n]}),Object(v.jsxs)("div",{className:"apexcharts-tooltip-series-group apexcharts-active",style:{order:1,display:"flex"},children:[Object(v.jsx)("span",{className:"apexcharts-tooltip-marker",style:{backgroundColor:s}}),Object(v.jsxs)("div",{className:"apexcharts-tooltip-text",children:[Object(v.jsxs)("div",{children:[Object(v.jsxs)("span",{children:[p(a[c][n])," ",r.globals.seriesNames[c]]}),Object(v.jsx)("span",{className:"mx-1",children:"\u2022"}),Object(v.jsx)("span",{children:i.label})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("span",{children:"Updated "}),Object(v.jsx)(h.a,{fromNow:!0,children:t.updated[n]})]})]})]})]});return Object(N.renderToString)(o)}}};return Object(c.useEffect)((function(){var t=C(e.values),c=[].concat(n);c[0].data=t.aqi,w.a.exec(a,"updateSeries",Object(s.a)(c),!0);var i=Object(y.a)({},r);i.xaxis.categories=t.city,w.a.exec(a,"updateOptions",Object(y.a)({},i),!1,!0)}),[e]),Object(v.jsx)("div",{id:"chart",children:Object(v.jsx)("div",{className:"row",children:Object(v.jsxs)("div",{className:"col col-xl-10 mx-xl-auto",children:[Object(v.jsx)("h3",{className:"text-center mb-3",children:"Comparison Chart"}),Object(v.jsx)(k.a,{options:r,series:[].concat(n),type:"bar",height:350})]})})})},F=new WebSocket("ws://city-ws.herokuapp.com");F.onopen=function(){console.log("WebSocket Client Connected")};var D=function(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),a=t[0],n=t[1];return Object(c.useEffect)((function(){F.onmessage=function(e){var t=JSON.parse(e.data),a=new Date;t.length>0&&n((function(e){var c=Object(s.a)(e);return t.forEach((function(e){var t=e.city,n=e.aqi,r=Object(l.findIndex)(c,{city:t});r<0?c.push({city:t,aqi:n,updated:a}):(c[r].aqi=n,c[r].updated=a)})),Object(s.a)(c)}))}}),[]),Object(v.jsx)("div",{className:"container",children:Object(v.jsxs)("main",{className:"py-5",children:[Object(v.jsx)("div",{className:"mb-3 text-center",children:Object(v.jsx)("h2",{children:"Live Air Quality Monitoring"})}),a.length?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(g,{values:Object(s.a)(a)}),Object(v.jsx)(I,{values:Object(s.a)(a)})]}):Object(v.jsx)("div",{className:"d-flex justify-content-center py-5",children:Object(v.jsx)("div",{className:"spinner-border",role:"status",children:Object(v.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]})})},L=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,31)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),c(e),n(e),r(e),i(e)}))};i.a.render(Object(v.jsx)(n.a.StrictMode,{children:Object(v.jsx)(D,{})}),document.getElementById("root")),L()}},[[30,1,2]]]);
//# sourceMappingURL=main.221d5c5b.chunk.js.map